# Source Tree Analysis

> Generated by BMAD Document Project Workflow | 2025-12-13

## Project Structure Overview

```
zsh-tool/
├── install.sh                    # [ENTRY POINT] Main installation script
├── README.md                     # Project overview and quick start
├── CONTRIBUTING.md               # Contribution guidelines
├── CHANGELOG.md                  # Version history
├── LICENSE                       # MIT License
│
├── lib/                          # [CORE] Functionality modules
│   ├── core/                     # Shared utilities
│   │   └── utils.zsh            # Logging, prompts, error handling
│   │
│   ├── install/                  # [Epic 1] Installation modules
│   │   ├── prerequisites.zsh    # System requirements check
│   │   ├── backup.zsh           # Pre-installation backup
│   │   ├── omz.zsh              # Oh My Zsh installation
│   │   ├── config.zsh           # Configuration setup
│   │   ├── plugins.zsh          # Plugin installation
│   │   ├── themes.zsh           # Theme configuration
│   │   └── verify.zsh           # Installation verification
│   │
│   ├── update/                   # [Epic 2] Update operations
│   │   ├── self.zsh             # Self-update functionality
│   │   ├── omz.zsh              # Oh My Zsh updates
│   │   └── plugins.zsh          # Plugin updates
│   │
│   ├── restore/                  # [Epic 2] Backup & restore
│   │   ├── backup-mgmt.zsh      # Backup management
│   │   └── restore.zsh          # Restore operations
│   │
│   ├── git/                      # [Epic 2] Git integration
│   │   └── integration.zsh      # Dotfiles version control
│   │
│   └── integrations/             # [Epic 3] Optional integrations
│       ├── atuin.zsh            # Atuin shell history
│       └── amazon-q.zsh         # Amazon Q Developer CLI
│
├── templates/                    # Configuration templates
│   ├── config.yaml              # Team configuration template
│   └── zshrc.template           # .zshrc template
│
├── tests/                        # Test suite
│   ├── run-all-tests.sh         # Test runner
│   ├── test-amazon-q.zsh        # Amazon Q integration tests
│   └── test-amazon-q-edge-cases.zsh  # Edge case tests
│
├── docs/                         # Documentation (33 files)
│   ├── README.md                # User guide
│   ├── PRD.md                   # Product requirements
│   ├── solution-architecture.md # Technical architecture
│   ├── CODEBASE-ANALYSIS.md     # Code structure analysis
│   ├── project-context.md       # AI development context
│   ├── stories/                 # User stories (10 files)
│   └── [troubleshooting docs]   # Fix guides
│
├── scripts/                      # Utility scripts
│   └── cleanup-disk.sh          # Disk cleanup utility
│
├── .claude/                      # Claude Code integration
│   ├── hooks/                   # TTS and automation hooks
│   └── skills/                  # Claude skills
│
├── .bmad/                        # BMAD workflow system
│   ├── core/                    # Core workflows
│   ├── bmm/                     # Method workflows
│   └── _cfg/                    # Configuration
│
└── .github/                      # GitHub integrations
    ├── agents/                  # GitHub Copilot agents
    └── chatmodes/               # Chat mode configurations
```

## Critical Directories

### `/lib` - Core Functionality
The heart of zsh-tool. Contains all functional modules organized by domain:

| Directory | Purpose | Files |
|-----------|---------|-------|
| `core/` | Shared utilities (logging, prompts, state) | 1 |
| `install/` | Installation workflow modules | 7 |
| `update/` | Update and maintenance operations | 3 |
| `restore/` | Backup management and restoration | 2 |
| `git/` | Dotfiles version control | 1 |
| `integrations/` | Optional tool integrations | 2 |

### `/templates` - Configuration Templates
Contains base configuration files that are copied to user's config directory:
- `config.yaml` - Team configuration with plugins, themes, aliases
- `zshrc.template` - Base .zshrc template

### `/tests` - Test Suite
Contains integration tests primarily for the Amazon Q integration:
- Tests run with `zsh run-all-tests.sh`
- Focus on edge cases and compatibility

## Entry Points

| Entry Point | Purpose | Usage |
|-------------|---------|-------|
| `install.sh` | Initial installation | `zsh install.sh` |
| `zsh-tool-install` | Post-install setup | Run after installation |
| `zsh-tool-update` | Update everything | Keep tools current |
| `zsh-tool-backup` | Create backups | Before major changes |
| `zsh-tool-restore` | Restore from backup | Rollback changes |

## Module Loading Order

The `install.sh` generates a loader that sources modules in this order:

1. `core/utils.zsh` - Base utilities
2. `install/*.zsh` - Installation modules (Epic 1)
3. `update/*.zsh` - Update modules (Epic 2)
4. `restore/*.zsh` - Restore modules (Epic 2)
5. `git/integration.zsh` - Git integration (Epic 2)
6. `integrations/*.zsh` - Optional integrations (Epic 3)

## File Counts by Type

| Extension | Count | Purpose |
|-----------|-------|---------|
| `.zsh` | 16 | Core functionality |
| `.sh` | 3 | Shell scripts |
| `.md` | 33+ | Documentation |
| `.yaml` | 2 | Configuration |
| `.json` | 2 | State/config |
